<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Carta 3D Real ðŸ’Œ</title>
<style>
body{
  margin:0;
  overflow:hidden;
  background:linear-gradient(#ff9ecf,#ffd6ec);
}
canvas{
  display:block;
}
#texto{
  position:absolute;
  top:10%;
  width:100%;
  text-align:center;
  font-size:28px;
  color:white;
  font-family:cursive;
  text-shadow:0 0 10px #ff4da6;
  z-index:2;
}
</style>
</head>
<body>

<div id="texto">Toca la carta ðŸ’Œ</div>

<script src="https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.min.js"></script>

<script>

const scene = new THREE.Scene();

const camera = new THREE.PerspectiveCamera(60, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(0,1,6);

const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

/* LUCES */

const ambient = new THREE.AmbientLight(0xffffff,0.8);
scene.add(ambient);

const light = new THREE.PointLight(0xff69b4,2);
light.position.set(5,5,5);
scene.add(light);

/* GRUPO CARTA */

const group = new THREE.Group();
scene.add(group);

/* BASE */

const baseGeo = new THREE.BoxGeometry(4,2.5,0.3);
const baseMat = new THREE.MeshStandardMaterial({
  color:0xff4da6,
  roughness:0.4,
  metalness:0.2
});
const base = new THREE.Mesh(baseGeo,baseMat);
group.add(base);

/* TAPA */

const flapGeo = new THREE.BoxGeometry(4,2,0.2);
const flapMat = new THREE.MeshStandardMaterial({
  color:0xff2d8f,
});
const flap = new THREE.Mesh(flapGeo,flapMat);
flap.position.y = 2.2;
flap.position.z = -0.1;
flap.rotation.x = Math.PI/6;
group.add(flap);

/* ALAS REALES */

function createWing(side){
  const wingGeo = new THREE.SphereGeometry(1.2,32,32,0,Math.PI/2);
  const wingMat = new THREE.MeshStandardMaterial({
    color:0xffffff,
    transparent:true,
    opacity:0.9
  });
  const wing = new THREE.Mesh(wingGeo,wingMat);
  wing.scale.set(1,1.5,0.3);
  wing.position.x = side * 2.8;
  wing.position.y = 0.5;
  group.add(wing);
  return wing;
}

const leftWing = createWing(-1);
const rightWing = createWing(1);

let opened = false;

window.addEventListener("click",()=>{

  if(!opened){
    opened = true;

    /* AnimaciÃ³n apertura */
    let openAnim = setInterval(()=>{
      if(flap.rotation.x > -Math.PI/1.2){
        flap.rotation.x -= 0.05;
      }else{
        clearInterval(openAnim);
      }
    },16);

    /* CÃ¡mara entra */
    setTimeout(()=>{
      let zoom = setInterval(()=>{
        if(camera.position.z > 3){
          camera.position.z -= 0.05;
        }else{
          clearInterval(zoom);
          document.getElementById("texto").innerHTML =
          "Â¿Quieres ser mi San ValentÃ­n? ðŸ’•";
        }
      },16);
    },800);
  }
});

/* ANIMACIÃ“N ALAS */

function animate(){
  requestAnimationFrame(animate);

  leftWing.rotation.z = Math.sin(Date.now()*0.003)*0.3;
  rightWing.rotation.z = -Math.sin(Date.now()*0.003)*0.3;

  renderer.render(scene,camera);
}

animate();

window.addEventListener("resize",()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth,window.innerHeight);
});

</script>

</body>
</html>
